# Ручное обновление базы данных на сервере

## Шаг 1: Подключение к серверу
```bash
ssh root@217.198.6.238
```

## Шаг 2: Переход в директорию проекта
```bash
cd /root/supermock
# или
cd /path/to/your/project
```

## Шаг 3: Получение последних изменений
```bash
git pull origin master
```

## Шаг 4: Установка зависимостей (если нужно)
```bash
npm install
```

## Шаг 5: Обновление Prisma клиента
```bash
npx prisma generate
```

## Шаг 6: Применение изменений схемы к базе данных
```bash
npx prisma db push
```

## Шаг 7: Перезапуск сервера
```bash
# Если используете PM2
pm2 restart supermock-backend

# Или если используете systemd
sudo systemctl restart supermock-backend

# Или если запускаете напрямую
# Остановите текущий процесс и запустите заново
```

## Шаг 8: Проверка обновления
```bash
# Проверка здоровья сервера
curl http://localhost:3001/health

# Проверка API эндпоинтов
curl http://localhost:3001/api
```

## Проверка новой таблицы

После обновления можно проверить, что новая таблица `user_form_data` создана:

```bash
# Подключение к базе данных PostgreSQL
psql -U postgres -d supermock

# Проверка таблиц
\dt

# Проверка структуры новой таблицы
\d user_form_data

# Выход из psql
\q
```

## Возможные проблемы и решения

### Проблема: Prisma не может подключиться к базе данных
```bash
# Проверьте переменные окружения
cat .env

# Убедитесь, что DATABASE_URL правильный
```

### Проблема: Права доступа к файлам
```bash
# Дайте права на выполнение скриптов
chmod +x scripts/*.js
```

### Проблема: Порт занят
```bash
# Найдите процесс, использующий порт
lsof -i :3001

# Остановите процесс
kill -9 <PID>
``` 