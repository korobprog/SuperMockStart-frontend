# ✅ Чек-лист подготовки к деплою на Dokploy

## Подготовка сервера

- [ ] Установлен Dokploy на сервер
- [ ] Настроен Docker Swarm
- [ ] Открыты порты 80, 443, 3000
- [ ] Настроен DNS для доменов

## Подготовка проекта

- [ ] Все файлы добавлены в репозиторий
- [ ] Настроены переменные окружения в `env.dokploy`
- [ ] Проверены Dockerfile'ы
- [ ] Проверен docker-compose.yml
- [ ] Настроены .dockerignore файлы

## Настройка Dokploy

### Docker Compose проект

- [ ] Создан новый Docker Compose проект
- [ ] Указан правильный репозиторий
- [ ] Указана правильная ветка
- [ ] Загружен docker-compose.yml
- [ ] Настроены переменные окружения

### Домены

- [ ] Настроен домен для фронтенда (порт 80)
- [ ] Настроен домен для API (порт 3001)
- [ ] Включен HTTPS с Let's Encrypt
- [ ] Проверена доступность доменов

## Переменные окружения

- [ ] `TELEGRAM_TOKEN` - токен бота
- [ ] `JWT_SECRET` - безопасный секрет
- [ ] `BOT_USERNAME` - имя бота
- [ ] `FRONTEND_URL` - URL фронтенда
- [ ] `DATABASE_URL` - строка подключения к БД

## База данных

- [ ] Выполнены миграции Prisma
- [ ] Проверена связь с базой данных
- [ ] Настроены индексы
- [ ] Проверена работа API

## Безопасность

- [ ] Все секреты в переменных окружения
- [ ] Настроен CORS
- [ ] Настроен Rate Limiting
- [ ] Включен HTTPS
- [ ] Проверены заголовки безопасности

## Мониторинг

- [ ] Настроены логи приложений
- [ ] Настроены логи базы данных
- [ ] Проверена работа health checks
- [ ] Настроены уведомления об ошибках

## Автоматизация

- [ ] Настроен GitHub Actions
- [ ] Настроены webhooks
- [ ] Проверен автоматический деплой
- [ ] Настроен откат к предыдущим версиям

## Тестирование

- [ ] Проверена работа фронтенда
- [ ] Проверена работа API
- [ ] Проверена аутентификация через Telegram
- [ ] Проверена работа базы данных
- [ ] Проверена работа в продакшене

## Документация

- [ ] Обновлен README.md
- [ ] Создан DEPLOY.md
- [ ] Создан README-DEPLOY.md
- [ ] Документированы переменные окружения

## Финальная проверка

- [ ] Приложение доступно по домену
- [ ] API отвечает на запросы
- [ ] База данных работает корректно
- [ ] Логи показывают отсутствие ошибок
- [ ] Все функции работают в продакшене

---

## Полезные команды

### Проверка статуса сервисов

```bash
docker service ls
```

### Просмотр логов

```bash
docker service logs <service-name>
```

### Подключение к контейнеру

```bash
docker exec -it <container-name> sh
```

### Проверка базы данных

```bash
docker exec -it <backend-container> npx prisma studio
```

### Перезапуск сервиса

```bash
docker service update --force <service-name>
```
