# Тестирование функциональности формы

## Описание

Реализована функциональность отправки данных формы с страницы `/collectingcontacts` на сервер и перенаправления на страницу `/interview` при успешной отправке.

## Что было реализовано

### Backend

1. **Новый контроллер** `backend/src/controllers/formController.ts`:

   - `saveFormData` - сохранение данных формы
   - `getFormData` - получение данных формы пользователя

2. **Новый роут** `backend/src/routes/form.ts`:

   - `POST /api/form` - сохранение данных
   - `GET /api/form` - получение данных

3. **Обновлена схема базы данных**:

   - Добавлена таблица `UserFormData` для хранения полных данных формы
   - Связь с пользователем через `userId`

4. **Обновлены основные роуты** `backend/src/routes/index.ts`:
   - Добавлен роут `/api/form`

### Frontend

1. **Обновлена страница** `src/pages/Collectingcontacts.tsx`:

   - Добавлена отправка данных на сервер через API
   - Добавлено перенаправление на `/interview` при успешной отправке
   - Добавлена обработка ошибок

2. **Обновлена конфигурация Vite** `vite.config.ts`:
   - Добавлено проксирование API запросов на `http://localhost:3000`

## Как тестировать

### 1. Запуск серверов

```bash
# Backend (в папке backend)
npm run dev

# Frontend (в корневой папке)
npm run dev
```

### 2. Тестирование функциональности

1. Откройте приложение в браузере
2. Перейдите на страницу `/collectingcontacts`
3. Заполните форму:
   - Выберите профессию (обязательно)
   - Выберите страну/язык (обязательно)
   - Выберите опыт работы (обязательно)
   - Введите email (опционально)
   - Введите телефон (опционально)
4. Нажмите кнопку "Пройти собеседование"
5. При успешной отправке вы должны быть перенаправлены на страницу `/interview`

### 3. Проверка данных в базе

После отправки формы данные сохраняются в двух таблицах:

- `selected_professions` - выбранная профессия
- `user_form_data` - полные данные формы
- Статус пользователя обновляется на `CANDIDATE`

## API Endpoints

### POST /api/form

**Заголовки:**

```
Authorization: Bearer <telegram_token>
Content-Type: application/json
```

**Тело запроса:**

```json
{
  "profession": "frontend-developer",
  "country": "RU",
  "experience": "1-3",
  "email": "user@example.com",
  "phone": "+7 (999) 123-45-67"
}
```

**Ответ:**

```json
{
  "success": true,
  "message": "Form data saved successfully",
  "data": {
    "profession": "frontend-developer",
    "country": "RU",
    "experience": "1-3",
    "email": "user@example.com",
    "phone": "+7 (999) 123-45-67"
  }
}
```

### GET /api/form

**Заголовки:**

```
Authorization: Bearer <telegram_token>
```

**Ответ:**

```json
{
  "success": true,
  "data": {
    "profession": "frontend-developer",
    "status": "CANDIDATE"
  }
}
```

## Обработка ошибок

- Если пользователь не авторизован (нет токена), показывается сообщение об ошибке
- Если обязательные поля не заполнены, показывается валидационная ошибка
- Если сервер недоступен, показывается сообщение об ошибке сети
- При успешной отправке происходит перенаправление на страницу интервью
